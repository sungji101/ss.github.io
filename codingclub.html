<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR코드 인증 시스템</title>
    <!-- jQuery를 사용하기 위한 CDN 추가 -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body>

    <h1>QR코드 인증 시스템</h1>
    
    <div id="qr-scanner-container">
        <!-- QR코드 스캐너를 표시할 공간 -->
        <div id="qr-scanner"></div>
    </div>

    <form id="authentication-form">
        <label for="response_id">응답 ID:</label>
        <input type="text" id="response_id" name="response_id" required>
        <button type="button" onclick="authenticate()">인증 확인</button>
    </form>

    <div id="authentication-result"></div>

    <!-- QR코드 스캐너 라이브러리 추가 -->
    <script src="https://cdn.rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>

    <script>
        // QR코드 스캐너 초기화
        let scanner = new Instascan.Scanner({ video: document.getElementById('qr-scanner') });
        scanner.addListener('scan', function (content) {
            // 스캔된 QR코드 내용을 응답 ID 입력 필드에 자동으로 채웁니다.
            $('#response_id').val(content);
        });

        // QR코드 스캐너 시작
        Instascan.Camera.getCameras().then(function (cameras) {
            if (cameras.length > 0) {
                scanner.start(cameras[0]);
            } else {
                console.error('카메라를 찾을 수 없습니다.');
            }
        }).catch(function (e) {
            console.error(e);
        });

        // 폼 제출 시 인증 확인
        function authenticate() {
            let responseId = $('#response_id').val();
            
            // 예시로 간단히 로컬에서 확인하도록 설정
            let idList = ['id1', 'id2', 'id3'];  // 실제 응답 ID 리스트를 여기에 추가하세요

            if (idList.includes(responseId)) {
                $('#authentication-result').text('인증되었습니다');
            } else {
                $('#authentication-result').text('인증에 실패했습니다');
            }
        }
    </script>
</body>
</html>
